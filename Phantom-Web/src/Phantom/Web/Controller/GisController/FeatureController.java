package Phantom.Web.Controller.GisController;

import org.apache.log4j.Logger;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import com.vividsolutions.jts.geom.Geometry;

import Phantom.API.Util.SpatialUtil;

@Controller
@RequestMapping(value = "/FeatureController")
public class FeatureController {

	private static Logger logger = Logger.getLogger(FeatureController.class);

	@ResponseBody
	@RequestMapping(value = "/getLineLength")
	public double getLineLength(String wkt) {
		Geometry geom = SpatialUtil.createGeometryByWKT(wkt);
		double length = geom.getLength();
		logger.info(wkt);
		logger.info(length);
		return length;
	}
	
	@ResponseBody
	@RequestMapping(value = "/getPolygonArea")
	public double getPolygonArea(String wkt){
		Geometry geom = SpatialUtil.createGeometryByWKT(wkt);
		double area = geom.getArea();
		double area2 = SpatialUtil.getArea(geom);
		logger.info(wkt);
		logger.info(area);
		logger.info(area2);
		return area;
	}
	
	@ResponseBody
	@RequestMapping(value = "/getLineStringWKT")
	public String getLine(){
		String wkt = "LINESTRING(114.42693039171455 30.531672063192357,114.42644213257456 30.53216693808704,114.42583841756401 30.5326142800489,114.42514031117715 30.53305467671501,114.42437217115658 30.533485000115892,114.42364534276606 30.533849045944297,114.42075084807738 30.535328191981186,114.4181249581472 30.53676392566229,114.4181249581472 30.53676392566229,114.41749620601576 30.53714333069515,114.41667311918523 30.537587516557544,114.4148423738235 30.539366654665695,114.4126133607344 30.541296682910193,114.41194547370804 30.541832994076394,114.41083577652627 30.542724167738704,114.40957808336573 30.543407327852602,114.40528735309911 30.54467747191618,114.40497447895346 30.544888005969632,114.40452888363212 30.54557277917806,114.40440797227852 30.546156161286444,114.40437980351695 30.552130326939103,114.40418133634532 30.554106487942324,114.4030255661731 30.560033971090633,114.40213548789399 30.562615890577288,114.40130322020248 30.56471342407662,114.40034436472085 30.566016202832042,114.3993574328868 30.566921489584736,114.39778046434807 30.5678819084008,114.39513040416236 30.569239013666063,114.39367106322251 30.570310074363036,114.39334204171922 30.570819462176736,114.39228694040447 30.572453096000903,114.39120335065017 30.576019187117303,114.39046298483447 30.577959085791175,114.38972251937253 30.57903034048321,114.38883175897743 30.57997210889204,114.38729696665845 30.58084868798019,114.38453000731752 30.58189750983367,114.38307987216426 30.582445210913683)";
		//Geometry geom = SpatialUtil.createGeometryByWKT(wkt);
		return wkt;
	}

}
